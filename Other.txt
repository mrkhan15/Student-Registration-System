 
 
 # in case Image resize dont work
 if filename:
        # img = Image.open(filename)
        # img.thumbnail((190, 190))
        # photo2 = ImageTk.PhotoImage(img)
        # label.configure(image=photo2)
        # label.image = photo2



#Search Bar testing ----->
def perform_search():
    text = search_entry.get()
    clear()
    print(f"Performing search for: {text}")
    Savebutton.configure(state='disable')

    try:
        file = load_workbook("Test_Data.xlsx")
        sheet = file.active

        for row in sheet.iter_rows(min_row=2):
            print(f"Checking row: {row}")
            print(f"Comparing {row[0].value} with {int(text)}")
            if row[0].value == int(text):
                # Assuming you have labels for displaying data
                Name.set(row[1].value)   # Full Name
                DOB.set(row[2].value)    # Date of Birth
                # ... (Update other fields similarly)

                print(f"Data found for registration number {text}")
                return  # Exit the loop once data is found

        # If the loop completes without finding data
        messagebox.showerror("Error", f"No data found for the given registration number {text}")

    except FileNotFoundError as e:
        print(f"File not found: {e}")
        messagebox.showerror("Error", "File not found")
    except Exception as e:
        print(f"An error occurred: {e}")
        messagebox.showerror("Error", "An error occurred while searching")



#Half Working Search code
def perform_search():
    text = search_entry.get()
    clear()
    print(f"Performing search for: {text}")
    Savebutton.configure(state='disable')

    try:
        file = load_workbook("Test_Data.xlsx")
        sheet = file.active

        # Print all column headers
        all_headers = [col[0].value for col in sheet.iter_cols(min_row=1, max_row=1)]
        print(f"All column headers: {all_headers}")

        # Find the column index for "Registration number" header
        # Find the column index for "Registration No." header
        registration_number_col = None
        for col_index, col in enumerate(sheet.iter_cols(min_row=1, max_row=1), 1):
            if col[0].value == "Registration No.":
                registration_number_col = col_index
                break


        if registration_number_col is not None:
            print(f"Found 'Registration number' column at index: {registration_number_col}")

            # Iterate over rows starting from the second row
            for row_index, row in enumerate(sheet.iter_rows(min_row=2), 2):
                reg_number_cell = row[registration_number_col - 1]  # Adjusting for 0-based index
                print(f"Checking row {row_index}: {row}")
                print(f"Registration number in row {row_index}: {reg_number_cell.value}")
                print(f"Comparing {reg_number_cell.value} with {int(text)}")
                if str(reg_number_cell.value) == str(text):
                    # Assuming you have labels for displaying data
                    Name.set(row[1].value)   # Full Name
                    DOB.set(row[2].value)    # Date of Birth
                    # ... (Update other fields similarly)

                    print(f"Data found for registration number {text}")
                    return  # Exit the loop once data is found

            # If the loop completes without finding data
            print(f"No data found for the given registration number {text}")
            messagebox.showerror("Error", f"No data found for the given registration number {text}")
        else:
            print("Column 'Registration number' not found in the Excel sheet")
            messagebox.showerror("Error", "Column 'Registration number' not found in the Excel sheet")

    except FileNotFoundError as e:
        print(f"File not found: {e}")
        messagebox.showerror("Error", "File not found")
    except Exception as e:
        print(f"An error occurred: {e}")
        messagebox.showerror("Error", "An error occurred while searching") 